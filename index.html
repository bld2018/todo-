<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠéº»åˆ†ç²¾å‡†åŒ¹é…ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="style.css">
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
</head>
<body>
    <!-- å…¨å±€åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div id="globalLoadingIndicator" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(255,255,255,0.95); z-index: 9999; justify-content: center;
    align-items: center; flex-direction: column;">
        <div style="font-size: 3rem; margin-bottom: 20px; animation: spin 1s linear infinite;">ğŸ”„</div>
        <div id="loadingText" style="font-size: 1.3rem; color: #1890ff; font-weight: bold; margin-bottom: 20px;">
            æ­£åœ¨è®¡ç®—...
        </div>
        <div style="width: 350px; margin-bottom: 15px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <span style="color: #595959;">è®¡ç®—è¿›åº¦:</span>
                <span id="progressPercent" style="color: #1890ff; font-weight: bold;">0%</span>
            </div>
            <div style="height: 12px; background: #f0f0f0; border-radius: 6px; overflow: hidden;">
                <div id="progressBar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #1890ff, #40a9ff);
                transition: width 0.3s ease; border-radius: 6px;"></div>
            </div>
        </div>
    </div>

    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-left">
                <div class="logo">ğŸ¯ èŠéº»åˆ†ç»„é˜Ÿç³»ç»Ÿ</div>
            </div>
            <div class="nav-right">
                <span id="userStatus" style="display: none; margin-right: 15px;"></span>
                <button class="btn btn-primary" id="adminLoginBtn">
                    âš™ï¸ ç®¡ç†åå°
                </button>
            </div>
        </div>
    </nav>

    <!-- ç³»ç»Ÿå…¬å‘Š -->
    <div class="announcement">
        <div class="container">
            <div class="announcement-icon">ğŸ“¢</div>
            <div class="announcement-text">
                <strong>ç³»ç»Ÿå…¬å‘Šï¼š</strong>æœ¬ç³»ç»ŸæŸ¥æ‰¾æ€»åˆ†<strong>æ°å¥½ç­‰äº2026</strong>çš„3äººç»„åˆï¼Œå·²ä¼˜åŒ–æ”¯æŒ1000+ç”¨æˆ·ï¼ˆå°çº¢ä¹¦ï¼šåˆèœåˆçˆ±ç©ï¼Œå…³æ³¨ä¸è¿·è·¯ï¼ï¼‰
                <br>
                <strong style="color: #ff4d4f;">âš ï¸ æ³¨æ„ï¼š</strong>çº¢è‰²IDä¸ºéæ­£å¸¸å°çº¢ä¹¦ç”¨æˆ·ï¼Œè¯·æ³¨æ„å¹¶å¿½ç•¥
            </div>
        </div>
    </div>

    <div class="container main-container">
        <div class="grid">
            <!-- å·¦ä¾§ï¼šç™»è®°ç»„é˜Ÿ -->
            <div class="card">
                <div class="card-header">
                    <h2>ğŸ“‹ ç™»è®°ç»„é˜Ÿ</h2>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label for="nameInput">å°çº¢ä¹¦å·ï¼šID<span class="required">*</span></label>
                        <input type="text" id="nameInput" placeholder="ä¾‹å¦‚ï¼š2789378855" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="scoreInput">èŠéº»åˆ† (350-950)<span class="required">*</span></label>
                        <input type="number" id="scoreInput" min="350" max="950" placeholder="ä¾‹å¦‚ï¼š829" class="form-control">
                    </div>
                    <button class="btn btn-primary btn-block" id="addParticipantBtn">
                        <span class="btn-icon">âœš</span>ç™»è®°ç»„é˜Ÿ
                    </button>
                </div>
            </div>

            <!-- ä¸­é—´ï¼šå‚ä¸è€…åˆ—è¡¨ -->
            <div class="card">
                <div class="card-header">
                    <h2>ğŸ‘¥ å·²ç™»è®°å‚ä¸è€… (<span id="participantCount">0</span>)</h2>
                </div>
                <div class="card-body">
                    <div class="participants-list" id="participantsList">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ‘¥</div>
                            <p>æš‚æ— å‚ä¸è€…</p>
                            <p class="empty-text">è¯·åœ¨å·¦ä¾§æ·»åŠ å‚ä¸è€…ä¿¡æ¯</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æŒ‰åˆ†æ•°æŸ¥æ‰¾ -->
            <div class="card">
                <div class="card-header">
                    <h3>ğŸ“Š æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·</h3>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label>èŠéº»åˆ†æ•°</label>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <input type="number" id="scoreSearchInput" class="form-control" placeholder="è¾“å…¥èŠéº»åˆ†æ•°" 
                            style="flex: 1; min-width: 150px;" min="1" max="2026">
                            <button class="btn btn-primary" id="searchUsersBtn" style="white-space: nowrap;">
                                <span class="btn-icon">ğŸ”</span>æŸ¥æ‰¾
                            </button>
                            <button class="btn btn-outline" id="clearScoreSearchBtn" style="white-space: nowrap;">
                                <span class="btn-icon">â†º</span>é‡ç½®
                            </button>
                        </div>
                    </div>
                    <div id="scoreSearchResult" class="match-result" style="display: none;"></div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šåŒ¹é…ç»“æœ -->
            <div class="card">
                <div class="card-header">
                    <h2>ğŸ¯ æŸ¥è¯¢2026ç»„åˆ</h2>
                </div>
                <div class="card-body">
                    <button id="matchTeamsBtn" class="btn btn-success btn-block">
                        <span class="btn-icon">ğŸ”</span>ç«‹å³æŸ¥æ‰¾æ‰€æœ‰ç»„åˆ
                    </button>
                    
                    <div class="form-group" style="margin-top: 20px; padding: 15px; background: #f9fbfd; border-radius: 10px;">
                        <label for="queryNameInput" style="display: block; margin-bottom: 10px; font-weight: 600;">
                            ğŸ” æŸ¥è¯¢è‡ªå·±å°çº¢ä¹¦å·çš„ç»„åˆ
                        </label>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <input type="text" id="queryNameInput" class="form-control" placeholder="è¾“å…¥å°çº¢ä¹¦å·" 
                            style="flex: 1; min-width: 150px;">
                            <button class="btn btn-primary" id="queryCombinationsBtn" style="white-space: nowrap;">
                                <span class="btn-icon">ğŸ”</span>æŸ¥è¯¢
                            </button>
                            <button class="btn btn-danger" id="clearQueryBtn" style="white-space: nowrap;">
                                <span class="btn-icon">â†º</span>é‡ç½®
                            </button>
                        </div>
                    </div>
                    
                    <div id="queryResult" class="match-result" style="display: none;"></div>
                    <div id="matchResult" class="match-result">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ¯</div>
                            <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹åŒ¹é…</p>
                            <p class="empty-text">ç³»ç»Ÿå°†æŸ¥æ‰¾æ‰€æœ‰æ€»åˆ†æ°å¥½ç­‰äº2026çš„3äººç»„åˆ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ” ç”¨æˆ·ç™»å½•</h3>
                <span class="close" onclick="closeLoginModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="loginUsername">ç”¨æˆ·å</label>
                    <input type="text" id="loginUsername" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                </div>
                <div class="form-group">
                    <label for="loginPassword">å¯†ç </label>
                    <input type="password" id="loginPassword" class="form-control" placeholder="è¯·è¾“å…¥å¯†ç ">
                </div>
                <div id="loginError" class="error-message" style="display: none;"></div>
            </div>
            <button class="btn btn-primary btn-block" id="loginBtn">ç™»å½•</button>
        </div>
    </div>

    <!-- ç®¡ç†åå°ç™»å½•æ¨¡æ€æ¡† -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ” ç®¡ç†å‘˜ç™»å½•</h3>
                <span class="close" onclick="closeAdminLoginModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px; padding: 15px; background: #fff7e6; border-radius: 8px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="font-size: 1.2rem;">âš ï¸</div>
                        <div>
                            <strong>æ³¨æ„ï¼š</strong>æ­¤åŠŸèƒ½ä»…ä¾›ç®¡ç†å‘˜ä½¿ç”¨
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>ç®¡ç†å‘˜ç”¨æˆ·å</label>
                    <input type="text" id="adminUsername" class="form-control" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜ç”¨æˆ·å">
                </div>
                <div class="form-group">
                    <label>ç®¡ç†å‘˜å¯†ç </label>
                    <input type="password" id="adminPassword" class="form-control" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
                </div>
                <div id="adminLoginError" class="error-message" style="display: none;"></div>
                <button class="btn btn-primary btn-block" id="performAdminLoginBtn">ç™»å½•</button>
            </div>
        </div>
    </div>

    <style>
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .btn-loading {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .btn-loading::after {
            content: '';
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid #fff;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-left: 8px;
            vertical-align: middle;
        }
    </style>

    <script src="app.js"></script>
</body>
</html>