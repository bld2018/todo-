<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·åŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-container {
            max-width: 1000px;
            margin: 30px auto;
            padding: 20px;
        }
        .demo-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .feature-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .feature-header h1 {
            color: #1890ff;
            margin-bottom: 10px;
        }
        .test-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 25px 0;
        }
        .sample-data {
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .feature-list {
            background: #f0f5ff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .feature-list h3 {
            color: #1890ff;
            margin-top: 0;
        }
        .feature-list ul {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e6f4ff;
        }
        .feature-list li:last-child {
            border-bottom: none;
        }
        .feature-list li::before {
            content: "âœ…";
            margin-right: 10px;
        }
        .usage-example {
            background: #fff7e6;
            border: 1px solid #ffd591;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .usage-example h4 {
            color: #fa8c16;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="feature-header">
            <h1>ğŸ“Š æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·åŠŸèƒ½æ¼”ç¤º</h1>
            <p>ç›´æ¥æŸ¥è¯¢æŒ‡å®šèŠéº»åˆ†æ•°çš„æ‰€æœ‰å°çº¢ä¹¦ç”¨æˆ·</p>
        </div>

        <div class="sample-data">
            <h3>ğŸ“‹ æµ‹è¯•æ•°æ®ç¤ºä¾‹</h3>
            <p>ç³»ç»Ÿé¢„è®¾äº†ä¸€äº›æµ‹è¯•æ•°æ®ä¾›åŠŸèƒ½éªŒè¯ï¼š</p>
            <ul>
                <li><strong>åˆ†æ•° 666:</strong> å¤šä¸ªç”¨æˆ·ï¼ˆåŒ…å«TESTæµ‹è¯•æ•°æ®ï¼‰</li>
                <li><strong>åˆ†æ•° 888:</strong> å‡ ä¸ªç”¨æˆ·</li>
                <li><strong>åˆ†æ•° 1000:</strong> å•ä¸ªç”¨æˆ·</li>
                <li><strong>åˆ†æ•° 9999:</strong> æ— åŒ¹é…ç”¨æˆ·ï¼ˆæµ‹è¯•ç©ºç»“æœï¼‰</li>
            </ul>
        </div>

        <div class="test-controls">
            <button class="btn btn-primary" onclick="loadSampleData()">
                <span class="btn-icon">ğŸ“¥</span> åŠ è½½æµ‹è¯•æ•°æ®
            </button>
            <button class="btn btn-outline" onclick="testCommonScores()">
                <span class="btn-icon">âš¡</span> å¿«é€Ÿæµ‹è¯•å¸¸ç”¨åˆ†æ•°
            </button>
            <button class="btn btn-outline" onclick="clearAllData()">
                <span class="btn-icon">ğŸ§¹</span> æ¸…é™¤æ‰€æœ‰æ•°æ®
            </button>
        </div>

        <!-- æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·åŠŸèƒ½ -->
        <div class="demo-section">
            <h2>ğŸ” æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·</h2>
            <div class="form-group">
                <label>èŠéº»åˆ†æ•°</label>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <input type="number" id="scoreSearchInput" class="form-control" 
                           placeholder="è¾“å…¥èŠéº»åˆ†æ•°ï¼ˆå¦‚ 666ï¼‰" 
                           style="flex: 1; min-width: 200px;" min="1" max="2026">
                    <button class="btn btn-primary" onclick="searchUsersByScore()" style="white-space: nowrap;">
                        <span class="btn-icon">ğŸ”</span> æŸ¥æ‰¾ç”¨æˆ·
                    </button>
                    <button class="btn btn-outline" onclick="clearScoreSearch()" style="white-space: nowrap;">
                        <span class="btn-icon">â†º</span> é‡ç½®
                    </button>
                </div>
                <small class="form-text" style="margin-top: 8px; display: block;">
                    ğŸ’¡ æç¤ºï¼šè¾“å…¥å…·ä½“çš„èŠéº»åˆ†æ•°ï¼Œç³»ç»Ÿå°†æ˜¾ç¤ºæ‰€æœ‰æ‹¥æœ‰è¯¥åˆ†æ•°çš„å°çº¢ä¹¦ç”¨æˆ·
                </small>
            </div>
            <div id="scoreSearchResult" class="match-result" style="display: none;"></div>
        </div>

        <div class="feature-list">
            <h3>âœ¨ åŠŸèƒ½ç‰¹æ€§</h3>
            <ul>
                <li>ç›´æ¥æŒ‰èŠéº»åˆ†æ•°æŸ¥è¯¢ç”¨æˆ·ï¼Œæ— éœ€ç»„åˆåŒ¹é…</li>
                <li>æ”¯æŒ1-2026èŒƒå›´å†…çš„ä»»æ„åˆ†æ•°æŸ¥è¯¢</li>
                <li>æ¸…æ™°çš„ç»“æœå±•ç¤ºï¼ŒåŒ…å«ç”¨æˆ·IDã€å§“åã€åˆ†æ•°ç­‰ä¿¡æ¯</li>
                <li>è‡ªåŠ¨è¯†åˆ«å¹¶æ ‡è®°æµ‹è¯•æ•°æ®ï¼ˆTESTæ ‡è¯†ï¼‰</li>
                <li>æä¾›è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯é¢æ¿</li>
                <li>æ”¯æŒå›è½¦é”®å¿«é€ŸæŸ¥è¯¢</li>
                <li>å“åº”å¼è®¾è®¡ï¼Œé€‚é…å„ç§å±å¹•å°ºå¯¸</li>
                <li>å‹å¥½çš„ç©ºç»“æœæç¤º</li>
                <li>ä¸€é”®é‡ç½®åŠŸèƒ½</li>
                <li>å®æ—¶æ•°æ®éªŒè¯å’Œé”™è¯¯æç¤º</li>
            </ul>
        </div>

        <div class="usage-example">
            <h4>ğŸš€ ä½¿ç”¨ç¤ºä¾‹</h4>
            <ol>
                <li><strong>åŸºæœ¬æŸ¥è¯¢:</strong> è¾“å…¥åˆ†æ•°å¦‚"666"ï¼Œç‚¹å‡»"æŸ¥æ‰¾ç”¨æˆ·"</li>
                <li><strong>å¿«é€ŸæŸ¥è¯¢:</strong> åœ¨è¾“å…¥æ¡†ä¸­æŒ‰å›è½¦é”®ç›´æ¥æŸ¥è¯¢</li>
                <li><strong>æŸ¥çœ‹ç»Ÿè®¡:</strong> æŸ¥è¯¢ç»“æœåŒ…å«åŒ¹é…æ•°é‡ã€å¹³å‡åˆ†æ•°ç­‰ä¿¡æ¯</li>
                <li><strong>æµ‹è¯•æ•°æ®:</strong> ç³»ç»Ÿä¼šè‡ªåŠ¨æ ‡è®°TESTå¼€å¤´çš„æµ‹è¯•ç”¨æˆ·</li>
                <li><strong>é‡ç½®æŸ¥è¯¢:</strong> ç‚¹å‡»é‡ç½®æŒ‰é’®æ¸…ç©ºæŸ¥è¯¢æ¡ä»¶å’Œç»“æœ</li>
            </ol>
        </div>

        <div class="demo-section">
            <h3>ğŸ“± å“åº”å¼æµ‹è¯•</h3>
            <p>è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°æµ‹è¯•ç§»åŠ¨ç«¯é€‚é…æ•ˆæœï¼š</p>
            <ul>
                <li>å¤§å±å¹•ï¼ˆ>768pxï¼‰ï¼šæ¨ªå‘å¸ƒå±€ï¼Œä¿¡æ¯å¯†åº¦é«˜</li>
                <li>ä¸­ç­‰å±å¹•ï¼ˆ481px-768pxï¼‰ï¼šè‡ªé€‚åº”ç½‘æ ¼å¸ƒå±€</li>
                <li>å°å±å¹•ï¼ˆâ‰¤480pxï¼‰ï¼šå‚ç›´å †å å¸ƒå±€ï¼Œä¼˜åŒ–è§¦æ§ä½“éªŒ</li>
            </ul>
        </div>
    </div>

    <script src="config.js"></script>
    <script>
        // æ¨¡æ‹Ÿå…¨å±€å˜é‡
        let participants = [];

        // Toastæç¤ºå‡½æ•°
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background: ${type === 'success' ? '#52c41a' : type === 'error' ? '#ff4d4f' : type === 'warning' ? '#faad14' : '#1890ff'};
                color: white;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-size: 14px;
                font-weight: 500;
                animation: slideInRight 0.3s ease;
            `;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // åŠ è½½æµ‹è¯•æ•°æ®
        function loadSampleData() {
            participants = [
                { id: 'P001', name: 'å°çº¢ä¹¦ç”¨æˆ·1', score: 666, created_at: new Date() },
                { id: 'P002', name: 'TEST_user', score: 666, created_at: new Date() },
                { id: 'P003', name: 'å°çº¢ä¹¦ç”¨æˆ·2', score: 666, created_at: new Date() },
                { id: 'P004', name: 'å°çº¢ä¹¦ç”¨æˆ·3', score: 888, created_at: new Date() },
                { id: 'P005', name: 'TEST_data', score: 888, created_at: new Date() },
                { id: 'P006', name: 'å°çº¢ä¹¦ç”¨æˆ·4', score: 1000, created_at: new Date() },
                { id: 'P007', name: 'normal_user', score: 777, created_at: new Date() }
            ];
            showToast('æµ‹è¯•æ•°æ®åŠ è½½å®Œæˆï¼', 'success');
        }

        // æµ‹è¯•å¸¸ç”¨åˆ†æ•°
        function testCommonScores() {
            const commonScores = [666, 888, 1000, 777, 9999];
            let currentIndex = 0;
            
            function testNextScore() {
                if (currentIndex < commonScores.length) {
                    document.getElementById('scoreSearchInput').value = commonScores[currentIndex];
                    searchUsersByScore();
                    currentIndex++;
                    setTimeout(testNextScore, 1500);
                }
            }
            
            testNextScore();
        }

        // æ¸…é™¤æ‰€æœ‰æ•°æ®
        function clearAllData() {
            participants = [];
            clearScoreSearch();
            showToast('æ‰€æœ‰æ•°æ®å·²æ¸…é™¤', 'success');
        }

        // æ ¼å¼åŒ–æ—¥æœŸå‡½æ•°
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // ==================== æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·åŠŸèƒ½ ====================
        function searchUsersByScore() {
            const scoreInput = document.getElementById('scoreSearchInput');
            const resultEl = document.getElementById('scoreSearchResult');
            
            if (!scoreInput || !resultEl) {
                console.error('æ‰¾ä¸åˆ°æŒ‰åˆ†æ•°æŸ¥æ‰¾æ‰€éœ€çš„DOMå…ƒç´ ');
                return;
            }
            
            const score = parseInt(scoreInput.value.trim());
            
            // è¾“å…¥éªŒè¯
            if (!score || score < 1 || score > 2026) {
                showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„èŠéº»åˆ†æ•°ï¼ˆ1-2026ä¹‹é—´ï¼‰', 'error');
                scoreInput.focus();
                return;
            }
            
            // æŸ¥æ‰¾åŒ¹é…çš„ç”¨æˆ·
            const matchingUsers = participants.filter(participant => 
                participant.score === score
            );
            
            // æ˜¾ç¤ºç»“æœ
            displayScoreSearchResults(matchingUsers, score);
            
            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            resultEl.style.display = 'block';
        }

        function displayScoreSearchResults(users, targetScore) {
            const resultEl = document.getElementById('scoreSearchResult');
            
            if (users.length === 0) {
                resultEl.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“­</div>
                        <p>æœªæ‰¾åˆ°èŠéº»åˆ†ä¸º ${targetScore} çš„ç”¨æˆ·</p>
                        <p class="empty-text">å½“å‰æ•°æ®åº“ä¸­æ²¡æœ‰è¯¥åˆ†æ•°çš„å‚ä¸è€…</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #1890ff; margin-bottom: 15px;">
                        ğŸ¯ æ‰¾åˆ° ${users.length} ä½èŠéº»åˆ†ä¸º ${targetScore} çš„ç”¨æˆ·
                    </h4>
                </div>
                <div class="results-grid">
            `;
            
            // æŒ‰IDæ’åºæ˜¾ç¤ºç”¨æˆ·
            users.sort((a, b) => a.id.localeCompare(b.id)).forEach(user => {
                const isTestUser = user.name && (user.name.toUpperCase() === 'TEST' || user.name.toLowerCase().includes('test'));
                
                html += `
                    <div class="participant-card" style="
                        border-left: 4px solid ${isTestUser ? '#ff4d4f' : '#52c41a'};
                        background: ${isTestUser ? '#fff2f0' : '#f6ffed'};
                        margin-bottom: 12px;
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div class="participant-id" style="
                                    font-weight: bold;
                                    color: ${isTestUser ? '#ff4d4f' : '#262626'};
                                    font-size: 1.1rem;
                                ">${user.id}</div>
                                <div class="participant-name" style="
                                    color: ${isTestUser ? '#ff4d4f' : '#595959'};
                                    margin: 5px 0;
                                ">${user.name || 'æœªå¡«å†™'}</div>
                            </div>
                            <div class="participant-score" style="
                                font-size: 1.3rem;
                                font-weight: bold;
                                color: ${isTestUser ? '#ff4d4f' : '#52c41a'};
                            ">
                                ${user.score} åˆ†
                            </div>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.85rem; color: #8c8c8c;">
                            ç™»è®°æ—¶é—´: ${formatDate(user.created_at)}
                        </div>
                        ${isTestUser ? `
                            <div style="
                                margin-top: 8px;
                                padding: 4px 8px;
                                background: #ff4d4f;
                                color: white;
                                border-radius: 4px;
                                font-size: 0.8rem;
                                display: inline-block;
                            ">æµ‹è¯•æ•°æ®</div>
                        ` : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            
            // æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
            html += `
                <div style="
                    margin-top: 20px;
                    padding: 15px;
                    background: #f0f5ff;
                    border-radius: 8px;
                    border-left: 4px solid #1890ff;
                ">
                    <h5 style="margin: 0 0 10px 0; color: #1890ff;">ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯</h5>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <strong>æŸ¥è¯¢åˆ†æ•°:</strong> ${targetScore} åˆ†
                        </div>
                        <div>
                            <strong>åŒ¹é…ç”¨æˆ·æ•°:</strong> ${users.length} äºº
                        </div>
                        <div>
                            <strong>å¹³å‡èŠéº»åˆ†:</strong> ${targetScore} åˆ†
                        </div>
                        <div>
                            <strong>æŸ¥è¯¢æ—¶é—´:</strong> ${new Date().toLocaleString('zh-CN')}
                        </div>
                    </div>
                </div>
            `;
            
            resultEl.innerHTML = html;
        }

        function clearScoreSearch() {
            const scoreInput = document.getElementById('scoreSearchInput');
            const resultEl = document.getElementById('scoreSearchResult');
            
            if (scoreInput) {
                scoreInput.value = '';
            }
            if (resultEl) {
                resultEl.style.display = 'none';
                resultEl.innerHTML = '';
            }
            
            showToast('æŸ¥è¯¢å·²é‡ç½®', 'info');
        }

        // ä¸ºåˆ†æ•°è¾“å…¥æ¡†æ·»åŠ å›è½¦é”®æ”¯æŒ
        document.addEventListener('DOMContentLoaded', () => {
            const scoreInput = document.getElementById('scoreSearchInput');
            if (scoreInput) {
                scoreInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        searchUsersByScore();
                    }
                });
            }
        });

        // é¡µé¢åŠ è½½æ—¶æç¤º
        window.addEventListener('load', () => {
            setTimeout(() => {
                showToast('æ¬¢è¿ä½¿ç”¨æŒ‰åˆ†æ•°æŸ¥æ‰¾ç”¨æˆ·åŠŸèƒ½ï¼è¯·å…ˆç‚¹å‡»"åŠ è½½æµ‹è¯•æ•°æ®"', 'info');
            }, 1000);
        });
    </script>
</body>
</html>