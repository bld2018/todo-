<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»„åˆè®¡ç®—ä¿®å¤æµ‹è¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .result { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 3px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç»„åˆè®¡ç®—ä¿®å¤æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•åœºæ™¯</h2>
        <p>éªŒè¯ä¿®å¤åçš„ç»„åˆè®¡ç®—åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        <button onclick="runTest()">è¿è¡Œæµ‹è¯•</button>
        <button onclick="clearResults()">æ¸…ç©ºç»“æœ</button>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="testResults"></div>
    </div>

    <script src="app.js"></script>
    <script>
        // æµ‹è¯•æ•°æ®
        const testParticipants = [
            { id: 'P001', name: 'ç”¨æˆ·A', score: 1000 },
            { id: 'P002', name: 'ç”¨æˆ·B', score: 1026 },
            { id: 'P003', name: 'ç”¨æˆ·C', score: 500 },
            { id: 'P004', name: 'ç”¨æˆ·D', score: 526 },
            { id: 'P005', name: 'ç”¨æˆ·E', score: 800 },
            { id: 'P006', name: 'ç”¨æˆ·F', score: 1226 }
        ];

        function addResult(message, isSuccess = true) {
            const resultsDiv = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${isSuccess ? 'success' : 'error'}`;
            resultDiv.innerHTML = `${isSuccess ? 'âœ…' : 'âŒ'} ${message}`;
            resultsDiv.appendChild(resultDiv);
        }

        async function runTest() {
            try {
                addResult('å¼€å§‹æµ‹è¯•ç»„åˆè®¡ç®—åŠŸèƒ½...');
                
                // æµ‹è¯•1: åŸºæœ¬ç»„åˆè®¡ç®—
                addResult('æµ‹è¯•1: åŸºæœ¬ç»„åˆè®¡ç®—');
                const basicCombos = findAllPerfectCombinations(testParticipants, 2026);
                addResult(`æ‰¾åˆ° ${basicCombos.length} ä¸ªåŸºæœ¬ç»„åˆ`);
                
                // æµ‹è¯•2: ç²¾ç¡®ç®—æ³•
                addResult('æµ‹è¯•2: ç²¾ç¡®ç®—æ³•è®¡ç®—');
                const exactCombos = await calculateExactCombinations(testParticipants, 2026);
                addResult(`ç²¾ç¡®ç®—æ³•æ‰¾åˆ° ${exactCombos.length} ä¸ªç»„åˆ`);
                
                // æµ‹è¯•3: ä¼˜åŒ–ç®—æ³•
                addResult('æµ‹è¯•3: ä¼˜åŒ–ç®—æ³•è®¡ç®—');
                const optimizedCombos = await calculateOptimizedCombinations(testParticipants, 2026);
                addResult(`ä¼˜åŒ–ç®—æ³•æ‰¾åˆ° ${optimizedCombos.length} ä¸ªç»„åˆ`);
                
                // æµ‹è¯•4: å¯å‘å¼ç®—æ³•
                addResult('æµ‹è¯•4: å¯å‘å¼ç®—æ³•è®¡ç®—');
                const heuristicCombos = await calculateHeuristicCombinations(testParticipants, 2026);
                addResult(`å¯å‘å¼ç®—æ³•æ‰¾åˆ° ${heuristicCombos.length} ä¸ªç»„åˆ`);
                
                // æµ‹è¯•5: å»é‡åŠŸèƒ½
                addResult('æµ‹è¯•5: ç»„åˆå»é‡åŠŸèƒ½');
                const duplicateResults = [
                    { members: [testParticipants[0], testParticipants[1]], totalScore: 2026 },
                    { members: [testParticipants[1], testParticipants[0]], totalScore: 2026 }, // é‡å¤ç»„åˆ
                    { members: [testParticipants[2], testParticipants[3]], totalScore: 1026 }
                ];
                const uniqueResults = deduplicateCombinations(duplicateResults);
                addResult(`å»é‡å‰: ${duplicateResults.length} ä¸ª, å»é‡å: ${uniqueResults.length} ä¸ª`);
                
                addResult('ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼Œæœªå‡ºç°combo.reduceé”™è¯¯ï¼', true);
                
            } catch (error) {
                addResult(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, false);
                console.error('æµ‹è¯•é”™è¯¯:', error);
            }
        }

        function clearResults() {
            document.getElementById('testResults').innerHTML = '';
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºè¯´æ˜
        document.addEventListener('DOMContentLoaded', () => {
            addResult('ç³»ç»Ÿå·²å°±ç»ªï¼Œç‚¹å‡»"è¿è¡Œæµ‹è¯•"å¼€å§‹éªŒè¯ä¿®å¤æ•ˆæœ');
        });
    </script>
</body>
</html>